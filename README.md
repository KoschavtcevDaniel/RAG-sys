# Вопросно-ответная система RAG

## Цель

Разработать RAG систему для ответов на вопросы по конкретной области (в данном примере про студ отряды)

## Содержание

window.py - является оснонвым файлом, где содержится отображение декстопного приложения для взаимдействия с системой

agent.py - содержит оснонвые функции взаимодействия с Базой Данных и моделью нейросети

model_init.py - инициализирует модель и токенайзер для дальнейшего использования

vectorize.py - осуществляет вектаризацию текстовой базы данных, для дальнейшего поиска ближайших к запросу наборов текста, который будет передан для контекста

create_bd.py - заполняет текстовую базу данных на PostgreSQL в PGAdmin4

## Основная информация

Для векторизации текста из базы данных используется модель "paraphrase-MiniLM-L3-v2", небольшая модель, которая строит информативные эмбеддинги (энкодер).

Для вопросно-ответной системы используется "google/gemma-3-4b-it", которая показала лучший среди расммотренных моделей результат (время работы до 10 секунд). Модель, если не находила ифнормации в контексте, говорила: я не знаю ответа на вопрос, однако, если добавить РСО или студ отряды, модель продолжала генерацию, это можно объяснить мультиязычностью: модель, работающая на русском языке, лучше улавливает культурные и локальные темы, так как обучалась на такой информации.

Также рссматривались модели "google/gemma-3-1b-pt", "Qwen/Qwen2.5-7B-Instruct", "yandex/YandexGPT-5-Lite-8B-instruct". Первая модель недостаточно крупная для хороших ответов, путала даты и иногда выдавала пустой ответ. Вторая модель достаточно большая, выдавала хороший результат, но не всегда хорошо ловила локальный контекст, так как является многоязычной, а также работала в среднем за 20-30 секунд. Последняя модель запрашивала слишком много ресурсов для GPU, на CPU работала очень долго.

Модели обрабатывались на видеокарте NVIDIA GeForce RTX 4060 Laptop GPU

<img width="798" height="347" alt="б" src="https://github.com/user-attachments/assets/5788b091-c563-47fd-a13e-faee504f3665" />
Рисунок 1 - Модель отвечает на вопрос, контекста для которого нет в БД

<img width="799" height="575" alt="а" src="https://github.com/user-attachments/assets/eab9cea0-1fc3-48df-b31d-ace87d5092b7" />
Рисунок 2 - Модель отвечает на вопрос, контекст для которого есть в БД

## База данных на PostgreSQL

```
create table if not exists information(
	id_doc serial primary key,
	doc text not null
);

create table if not exists vectors(
	id_doc integer,
	embedding VECTOR(5000),
	FOREIGN KEY (id_doc) REFERENCES information(id_doc)
);
```
Код для создания таблиц в БД
